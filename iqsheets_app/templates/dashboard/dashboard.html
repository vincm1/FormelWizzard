{% extends "layout.html" %}{% block content %}
	<section class="home">
		<section class="dashboard ms-3">
			<div class="container-fluid my-3">

			{% if not current_user.premium %}
				<div class="d-flex flex-row my-5 premium-banner">
					<div class="banner col-xl-8 text-center">
						<h3>{{current_user.num_prompts}} von 3 Gratis KI-Anfragen verbaucht</h3>
					</div>
					<div class="banner col-xl-3 ms-5 text-center" id="premium-div">
						<a href="{{url_for('dashboard.premium')}}">
							<button class="btn btn-primary" id="premium-btn">
								<i class='bx bx-diamond icon pe-3'></i>
									Premium
							</button>
						</a>
					</div>				
				</div>
			{% endif %}

				<div class="d-flex flex-row explanation p-3 mb-4">
					<div class="col-xl-6 text-center">
						<img src="{{gif}}" alt="">
					</div>
					<div class="col-xl-6">
						<div class="row pt-3">
							<h3><img width="48" height="48" src="https://img.icons8.com/color/48/microsoft-excel-2019--v1.png" alt="microsoft-excel-2019--v1"/>
								<img width="48" height="48" src="https://img.icons8.com/color/48/google-sheets.png" alt="google-sheets"/>
								Lass Dir Formeln generieren oder erklären
							</h3>
						</div>
						<div class="row mt-5">
							<h6 class="pb-3">Hier ein paar Beispiel-Prompts für den Anfang:</h6>
							<ul>
								<li class="">"Teile den Text in Zelle A und multiplizieren diesen mit der 
									Differenz der Zellen A3 bis D4"
								</li>
								<li class="pt-4">
									"Wie nutze ich die Funktionen INDEX und MATCH zusammen, um eine leistungsstarke
									Nachschlageformel zu erstellen?"
								</li>
								<li class="pt-4">
									"Erstellen Sie eine Pivot-Tabelle auf der Grundlage der Spalten A bis D,
									gruppieren Sie nach Spalte B und summieren Sie Spalte D".
								</li>
							</ul>
							<h6 class="pt-3">Je präziser Dein Prompt, desto besser der Output!</h6>
						</div>
					</div>	
				</div>
				
				{% if current_user.premium or current_user.num_prompts < 4 %}
					<!-- Prompt Field -->
					<div class="d-flex flex-row justify-content-start">
						<div class="col-xl-5 col-sm-12 my-sm-3 formula">
							<div class="card formel-card">
								<div class="card-header">
									<img width="24" height="24" src="https://img.icons8.com/material-two-tone/24/multiple-inputs.png" 
									alt="multiple-inputs"/>
									Input
								</div>
								<form method="POST" action="{{url_for('dashboard.formel')}}" id="formula-form">
									{{form.hidden_tag()}}
								
								<div class="row form-row g-3">
									{{form.excel_google.label(class_="")}}
									{% for subfield in form.excel_google %}
										<div class="col-12 form-input">
											{% if subfield.data == "Excel" %}
												<img width="48" height="48" src="https://img.icons8.com/color/48/microsoft-excel-2019--v1.png" alt="microsoft-excel-2019--v1"/>
											{% else %}
												<img width="48" height="48" src="https://img.icons8.com/color/48/google-sheets.png" alt="google-sheets"/>
											{% endif %}
											{{subfield.label}}
											{{subfield}}
										</div>
									{% endfor %}
									{{ form.info_prompt.label(class_="mb-1") }}
									{% for subfield in form.info_prompt %}
										<div class="col-5 form-input-2 me-5 text-center"> <!-- Hier verwenden wir col-6 für zwei gleichbreite Spalten -->
											{{ subfield.label }}
											{{ subfield }}
										</div>
									{% endfor %}
									{{form.formula_explain.label(class_="mb-1")}}
									{% for subfield in form.formula_explain %}
										<div class="col-5 form-input-2 me-5 text-center"> <!-- Hier verwenden wir col-6 für zwei gleichbreite Spalten -->
											{{ subfield.label }}
											{{ subfield }}
										</div>
									{% endfor %}
									{{form.prompt.label(class="mb-2")}}	
									{{form.prompt(class="form-control p-2", placeholder="Summe Spalte A wenn Spalte B das Wort 'Sales' enthält z.B.")}}	
									{{form.submit(class="btn btn-primary col-12 my-2", id="formel-btn")}}
								</div>
								</form>
							</div>
						</div>

						<div class="col-xl-7 ms-1 col-sm-12 my-sm-3 me-2 formula">
						{% if form.formula_explain.data == "Erklären" %}
						<!-- Erklärung -->
							<div class="card">
								<div class="card-header">
									<img width="24" height="24" src="https://img.icons8.com/material-outlined/24/output.png" alt="output"/>
									Erklärung
								</div>
								<div class="card-body p-3">
									<div class="row">
										<p class="mt-2 mb-3 me-2 ms-2 p-3" id="copy-target">{{explanation}}</p>
									</div>
									<div class="d-flex flex-row">
										<form method="POST" action="{{url_for('dashboard.prompt_favorite', prompt_id=prompt.id)}}">
											<button class="p-2 pe-4 btn btn-primary me-5 align-items-center" name="favorite-btn" value="favorite-prompt" id="favorite-btn">
												<i class="fa-regular fa-heart ps-2 pe-1"></i> Favorit
											</button>
										</form>
										<form method="POST" action="{{url_for('dashboard.positive_feedback', prompt_id=prompt.id)}}">
											<button class="p-2 me-2 btn btn-success px-3" name="correct-btn" value="correct-response" id="incorrect-btn">
												<i class="fa-solid fa-check pe-2"></i> Richtig
											</button>
										</form>
										<form method="POST" action="{{url_for('dashboard.negative_feedback', prompt_id=prompt.id)}}">
											<button class="p-2 me-2 btn btn-danger px-3" name="incorrect-btn" value="incorrect-response" id="incorrect-btn">
												<i class="fa-solid fa-circle-xmark pe-2"></i> Falsch
											</button>
										</form>
											<button class="p-2 me-2 btn btn-outline-primary px-3 me-2" onclick="copyToClipboard()" id="copy-btn">
												<i class="fa-solid fa-copy pe-2"></i> Kopieren
											</button>
									</div>
								</div>
							</div>
						<!-- Erklärung End -->

						{% elif form.formula_explain.data == "Erstellen" %}
						<!-- Formel -->
							<div class="card">
								<div class="card-header">
									<img width="24" height="24" src="https://img.icons8.com/material-outlined/24/output.png" alt="output"/>
									<p>Formel</p>
								</div>
								<div class="card-body p-3">
									<div class="row">
										<p class="formel-erklaerung mt-2 mb-3 me-2 ms-2 p-3" id="copy-target">{{formula}}</p>
									</div>
									<hr>
									<div class="d-flex flex-row">
										<form method="POST" action="{{url_for('dashboard.prompt_favorite', prompt_id=prompt.id)}}">
											<button class="p-2 btn btn-primary me-5 align-items-center" name="favorite-btn" value="favorite-prompt" id="favorite-btn">
												<i class="fa-regular fa-heart ps-2 pe-1"></i> Favorit
											</button>
										</form>
										<form method="POST" action="{{url_for('dashboard.positive_feedback', prompt_id=prompt.id)}}">
											<button class="p-2 me-2 btn btn-success px-3" name="correct-btn" value="correct-response" id="incorrect-btn">
												<i class="fa-solid fa-check pe-2"></i> Richtig
											</button>
										</form>
										<form method="POST" action="{{url_for('dashboard.negative_feedback', prompt_id=prompt.id)}}">
											<button class="p-2 me-2 btn btn-danger px-3" name="incorrect-btn" value="incorrect-response" id="incorrect-btn">
												<i class="fa-solid fa-circle-xmark pe-2"></i> Falsch
											</button>
										</form>
											<button class="p-2 me-2 btn btn-outline-primary px-3 me-2" onclick="copyToClipboard()" id="copy-btn">
												<i class="fa-solid fa-copy pe-2"></i> Kopieren
											</button>
									</div>
								</div>
							</div>
					<!-- Formel End-->	
					{% else %}
						<!-- Unsubmitted -->
							<div class="card">
								<div class="card-header">
									<img width="24" height="24" src="https://img.icons8.com/material-outlined/24/output.png" alt="output"/>
									Formel / Erklärung
								</div>
								<div class="card-body p-3">
									<div class="row">
										<p>Lass dir eine Formel erstellen oder Erklären.</p>
									</div>
								</div>
							</div>
						<!-- Unsubmitted End-->
					{% endif %}

						</div>
						
					<!-- Prompt Field End-->	
					</div>

				{% else %}

				<div class="banner col-xl-10 mb-5">
					<h3>Keine Anfragen mehr übrig</h3>
					<button class="btn btn-primary premium-btn"><i class='bx bx-diamond icon'></i>Premium</button>
				</div>

				{% endif %}
						
					</div>
				</div>
		</section>
	</section>
{% endblock %}