{% extends "layout.html" %}{% block content %}
<section class="home">
  <div class="container mt-5 profile">
    <div class="flashmessages">
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div
        class="alert alert-{{ category }} alert-dismissible fade show"
        role="alert"
      >
        <strong>{{ message }}</strong>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
          aria-label="Close"
        ></button>
      </div>
      {% endfor %} {% endif %} {% endwith %}
    </div>

    <div class="card p-3 text-center">
      <form method="POST" enctype="multipart/form-data">
        {{form.hidden_tag()}}
        <div class="d-flex flex-row justify-content-center mt-2 mb-5">
          <div class="image">
            {% set s3_link =  "https://iqsheetsbucket.s3.eu-central-1.amazonaws.com/profile_pictures/" + current_user.profile_picture %}
            <img
              src="{{s3_link}}"
              class="rounded-circle"
            />
          </div>
          
          <div class="d-flex flex-column ms-3 user-details">
            <h4 class="mb-0 mt-2">{{current_user.username}}</h4>
            <h6 class="mt-2">{{current_user.job_description}}</h6>
          </div>
        </div>

        <div class="row justify-content-center">
          <div class="d-flex flex-row justify-content-center mt-2 mb-3">
						<a href="{{url_for('user.edit_user')}}"><button class="btn btn-outline-secondary">Profil bearbeiten</button></a>
						<button type="button" class="btn btn-primary mx-2" disabled>
							Passwort ändern
						</button>
					</div>
        </div>

        <div class="container">
          <div class="row justify-content-center">
            <div class="col-xl-6 col-lg-6 col-md-6 mt-4 mb-2">
              <div class="inputs">
                {{form.old_password(class="form-control",placeholder="Altes Passwort")}}
              </div>
              {% for error in form.old_password.errors %}
              <div
                class="alert alert-warning alert-dismissible fade show my-1"
                role="alert"
              >
                {{error}}
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="alert"
                  aria-label="Close"
                ></button>
              </div>
              {% endfor %}
            </div>
          </div>
          <div class="row justify-content-center">
            <div class="col-xl-6 col-lg-6 col-md-6 my-2">
              <div class="inputs">
                {{form.password(class="form-control",placeholder="Neues Passwort")}}
              </div>
              {% for error in form.password.errors %}
              <div
                class="alert alert-warning alert-dismissible fade show my-1"
                role="alert"
              >
                {{error}}
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="alert"
                  aria-label="Close"
                ></button>
              </div>
              {% endfor %}
            </div>
          </div>
          <div class="row justify-content-center">
            <div class="col-xl-6 col-lg-6 col-md-6 my-2">
              <div class="inputs">
                {{form.confirm_pw(class="form-control",placeholder="Neues Passwort bestätigen")}}
              </div>
              {% for error in form.confirm_pw.errors %}
              <div
                class="alert alert-warning alert-dismissible fade show my-1"
                role="alert"
              >
                {{error}}
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="alert"
                  aria-label="Close"
                ></button>
              </div>
              {% endfor %}
            </div>
          </div>
          <div class="row justify-content-end">
						<a href="{{url_for('user.reset_password_request')}}" class="btn btn-outline-primary col-xl-2 mt-3 me-2">Passwort vergessen?</a>
            {{form.submit(class="btn btn-primary col-xl-2 mt-3")}}
          </div>
        </div>
      </form>
    </div>
  </div>
</section>
{% endblock %}
